"use strict";var LIVERELOAD_PORT=35729,path=require("path");module.exports=function(grunt){require("matchdep").filterDev("grunt-*").forEach(grunt.loadNpmTasks),require("time-grunt")(grunt);var yeomanConfig={app:"app",dist:"dist"};try{yeomanConfig.app=require("./bower.json").appPath||yeomanConfig.app}catch(e){}grunt.loadNpmTasks("grunt-express"),grunt.loadNpmTasks("grunt-wiredep"),grunt.initConfig({yeoman:yeomanConfig,wiredep:{task:{ignorePath:/^\/|\.\.\//,src:["app/views/**/*.html","app/views/**/*.jade","app/styles/main.scss","app/config.yml"],options:{}}},watch:{coffee:{files:["<%= yeoman.app %>/scripts/{,*/}*.coffee"],tasks:["coffee:dist"]},coffeeTest:{files:["test/spec/{,*/}*.coffee"],tasks:["coffee:test"]},livereload:{options:{livereload:LIVERELOAD_PORT},files:["<%= yeoman.app %>/{,*/}*.html","{.tmp,<%= yeoman.app %>}/styles/{,*/}*.css","{.tmp,<%= yeoman.app %>}/scripts/{,*/}*.js","<%= yeoman.app %>/images/{,*/}*.{png,jpg,jpeg,gif,webp,svg}"]}},express:{options:{port:3e3,hostname:"*"},livereload:{options:{livereload:!0,server:path.resolve("app.js"),bases:[path.resolve("./.tmp"),path.resolve(__dirname,yeomanConfig.app)]}},test:{options:{server:path.resolve("app.js"),bases:[path.resolve("./.tmp"),path.resolve(__dirname,"test")]}},dist:{options:{server:path.resolve("app.js"),bases:path.resolve(__dirname,yeomanConfig.dist)}}},open:{server:{url:"http://localhost:<%= express.options.port %>"}},clean:{dist:{files:[{dot:!0,src:[".tmp","<%= yeoman.dist %>/*","!<%= yeoman.dist %>/.git*"]}]},server:".tmp"},jshint:{options:{jshintrc:".jshintrc"},all:["Gruntfile.js","<%= yeoman.app %>/scripts/{,*/}*.js"]},coffee:{dist:{files:[{expand:!0,cwd:"<%= yeoman.app %>/scripts",src:"{,*/}*.coffee",dest:".tmp/scripts",ext:".js"}]},test:{files:[{expand:!0,cwd:"test/spec",src:"{,*/}*.coffee",dest:".tmp/spec",ext:".js"}]}},rev:{dist:{files:{src:["<%= yeoman.dist %>/scripts/{,*/}*.js","<%= yeoman.dist %>/styles/{,*/}*.css","<%= yeoman.dist %>/images/{,*/}*.{png,jpg,jpeg,gif,webp,svg}","<%= yeoman.dist %>/styles/fonts/*"]}}},useminPrepare:{html:"<%= yeoman.app %>/index.html",options:{dest:"<%= yeoman.dist %>"}},usemin:{html:["<%= yeoman.dist %>/{,*/}*.html"],css:["<%= yeoman.dist %>/styles/{,*/}*.css"],options:{dirs:["<%= yeoman.dist %>"]}},imagemin:{dist:{files:[{expand:!0,cwd:"<%= yeoman.app %>/images",src:"{,*/}*.{png,jpg,jpeg}",dest:"<%= yeoman.dist %>/images"}]}},cssmin:{},htmlmin:{dist:{options:{},files:[{expand:!0,cwd:"<%= yeoman.app %>",src:["*.html","views/*.html"],dest:"<%= yeoman.dist %>"}]}},copy:{dist:{files:[{expand:!0,dot:!0,cwd:"<%= yeoman.app %>",dest:"<%= yeoman.dist %>",src:["*.{ico,png,txt}",".htaccess","bower_components/**/*","images/{,*/}*.{gif,webp,svg}","styles/fonts/*"]},{expand:!0,cwd:".tmp/images",dest:"<%= yeoman.dist %>/images",src:["generated/*"]}]}},concurrent:{server:["coffee:dist"],test:["coffee"],dist:["coffee","imagemin","htmlmin"]},karma:{unit:{configFile:"karma.conf.js",singleRun:!0}},cdnify:{dist:{html:["<%= yeoman.dist %>/*.html"]}},ngmin:{dist:{files:[{expand:!0,cwd:"<%= yeoman.dist %>/scripts",src:"*.js",dest:"<%= yeoman.dist %>/scripts"}]}},uglify:{dist:{files:{"<%= yeoman.dist %>/scripts/scripts.js":["<%= yeoman.dist %>/scripts/scripts.js"]}}}}),grunt.registerTask("server",function(target){return"dist"===target?grunt.task.run(["build","open","express:dist","express-keepalive"]):void grunt.task.run(["wiredep","clean:server","concurrent:server","express:livereload","open","watch"])}),grunt.registerTask("test",["wiredep","clean:server","concurrent:test","express:test","karma"]),grunt.registerTask("build",["wiredep","clean:dist","useminPrepare","concurrent:dist","concat","copy","cdnify","ngmin","cssmin","uglify","rev","usemin"]),grunt.registerTask("default",["jshint","test","build"])};